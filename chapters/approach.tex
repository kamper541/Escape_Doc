\chapter{\ifproject%
\ifcpe โครงสร้างและขั้นตอนการทำงาน\else Project Structure and Methodology\fi
\else%
\ifcpe โครงสร้างของโครงงาน\else Project Structure\fi
\fi
}

% ในบทนี้จะกล่าวถึงหลักการ และการออกแบบระบบ

\makeatletter

% \renewcommand\section{\@startsection {section}{1}{\z@}%
%                                    {13.5ex \@plus -1ex \@minus -.2ex}%
%                                    {2.3ex \@plus.2ex}%
%                                    {\normalfont\large\bfseries}}

\makeatother
%\vspace{2ex}
% \titleformat{\section}{\normalfont\bfseries}{\thesection}{1em}{}
% \titlespacing*{\section}{0pt}{10ex}{0pt}

\section{User interface (UI)}
User interface (UI) คือการออกแบบที่เน้นไปที่เรื่องหน้าตา ความสวยงาม และทุกอย่างที่จะเป็นการโต้ตอบกับผู้ใช้งาน โดยจะแสดงการเชื่อมโยงของแต่ละหน้าผ่าน user flow ดังรูปที่~\ref{userflow} UI ที่ดีจะช่วยดึงดูดผู้ใช้งานให้เกิดความสนใจและช่วยให้ผู้ใช้งานเข้าถึงข้อมูลได้ง่าย
โดยการออกแบบ UI ของเกมนี้พวกเราจะออกแบบเกมแนวตะลุยไปยังแผนที่ต่างๆ ที่มีสภาพแวดล้อมแตกต่างกัน โดยจะใช้ assets ที่มีอยู่ใน Unity มาปรับแต่งจัดวางเพื่อความสวยงามและความน่าสนใจ โดยจะมีส่วนต่างๆ ดังนี้
\begin{itemize}
\item หน้าจอแสดง main menu (รูปที่ \ref{mainmenu})
\item หน้าจอแสดงหน้าเลือกแผนที่ (รูปที่ \ref{map})
\item หน้าจอแสดงหน้าเลือกด่าน (รูปที่ \ref{stage})
\item หน้าจอแสดงหน้า gameplay (รูปที่ \ref{game})
\item หน้าต่างที่แสดงว่าเราชนะ (รูปที่ \ref{win})
\item หน้าต่างที่แสดงว่าเราแพ้ (รูปที่ \ref{lose})
\end{itemize}

\begin{figure}[h!]
    \begin{center}
    \includegraphics [width=\textwidth] {pic/UXflowchart.png}
    \end{center}
    \caption{User flow}
    \label{userflow}
    \end{figure}

\GBreply{ควรจะเอาขึ้นก่อนไหม? อธิบายด้วย ไม่ใช่ว่าแปะๆๆ อาจจะทำ User Flow ไหม?}
\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/home_start.PNG}
\end{center}
\caption[Mainmenu ของเกม]{หน้า main menu ของเกม}
\label{mainmenu}
\end{figure}


\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/MapSelection.png}
\end{center}
\caption[หน้าเลือกแผนที่]{หน้าเลือกแผนที่}
\label{map}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/LevelSelection1.png}
\end{center}
\caption[หน้าเลือกด่าน]{หน้าเลือกด่าน}
\label{stage}
\end{figure}


\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/NewGamePlay.png}
\end{center}
\caption[หน้า Gameplay]{หน้า gameplay}
\label{game}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/Complete.png}
\end{center}
\caption[หน้าต่างที่แสดงว่าชนะ]{หน้าต่างที่แสดงว่าชนะ}
\label{win}
\end{figure}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=1.75in]{pic/GameOver1.png}
\end{center}
\caption{หน้าต่าง game over}
\label{lose}
\end{figure}

\clearpage

\section{WebView}
เป็นตัวหน้าเว็บสำหรับนำ Google Blockly ไปใส่ใน panel ของ Unity เพราะเดิมที Unity ไม่สามารถสร้าง objects ที่มีหน้าตาและ functions เหมือนกับ Google Blockly ได้ ทางผู้พัฒนาจึงสร้างหน้าเว็บเข้ามาเพื่อนำไปใส่ใน 
panel ของ Unity ที่ใช้ในการแสดงผล block code

\begin{figure}[h!]
\begin{center}
\includegraphics{pic/CodePanel.png}
\end{center}
\caption[Google Blockly]{Google Blockly}
\label{block}
\end{figure}


\section{Text reader}
ด่านต่างๆ ของเกมนี้จะถูกระบุเป็น input ด้วยไฟล์ text สองชุด ประกอบไปด้วย text สำหรับแสดงผลของด่าน และ text สำหรับระบุว่าตำแหน่งใดสามารถไปได้หรือไม่ได้ กล่าวคือ เมื่อ user ทำการ input ไฟล์มา ตัวระบบเกมจะทำการจัดการสร้างด่านให้เอง
ทำให้การที่จะสร้างด่านหนึ่งด่านไม่ต้องเสียเวลาลากวางตัว prefabs บน Unity และสามารถรู้ผลแพ้ชนะของเกมได้โดยที่ตัวละครไม่จำเป็นต้องเดินไปจนจบชุดคำสั่งที่เข้ามา ซึ่งทำให้การทดสอบด่านนั้นเป็นไปได้เร็วขึ้น
ซึ่งแต่ละไฟล์ text จะมีรูปแบบดังนี้

\subsection{ไฟล์ text แสดงผลด่าน}
แต่ละบรรทัดของไฟล์ text แสดงผลด่านจะประกอบไปด้วย
\begin{enumerate}
    \item สภาพของด่านที่ต้องการจะแสดง folder ที่ใช้ในการเลือก prefabs ในปัจจุบันมี 3 สภาพด่าน ดังนี้
    \begin{itemize}
        \item Forest
        \item Dessert
        \item Snow
    \end{itemize}
    \item ความกว้างของด่านที่ต้องการจะสร้าง
    \item ความลึกของด่านที่ต้องการจะสร้าง
    \item ความสูงของด่าน
    \item ตั้งแต่บรรทัดนี้เป็นต้นไป เป็นการวาดด่านที่เราต้องการ โดยอิงตาม ความกว้าง/ความลึก/ความสูงของด่าน ที่ระบุโดยค่าใน 3 บรรทัดก่อนหน้านี้ โดยที่เราสามารถเพิ่ม prefabs เองได้ใน folder \str{Asset/Resources/MapDesign/MapResources} โดยสัญลักษณ์ของ prefabs ที่เพิ่มเข้าไป จะเป็นไปตามชื่อไฟล์นั้นๆ เริ่มต้นจะมีสัญลักษณ์ให้ใช้ดังนี้
    \begin{itemize}
        \item 0 -- ไม่สร้างอะไร
        \item 1 -- พื้นรูปแบบที่ 1 (ขึ้นอยู่กับสภาพของด่านที่เลือก)
        \item 2 -- พื้นรูปแบบที่ 2 (ขึ้นอยู่กับสภาพของด่านที่เลือก)
        \item R -- หิน
        \item T -- ต้นไม้
        \item W -- พื้นรูปน้ำ
    \end{itemize}
\end{enumerate}
รูปที่~\ref{ft1} แสดงตัวอย่างของไฟล์ text แสดงผลด่าน
\begin{figure}[h!]
    \begin{center}
    \includegraphics[width=1in]{pic-toro/filetext1.png}
    \end{center}
    \caption[Text]{ไฟล์ text แสดงผลด่าน}
    \label{ft1}
    \end{figure}

\subsection{ไฟล์ text สำหรับบอกจุดที่สามารถไปได้}
แต่ละบรรทัดของไฟล์ text สำหรับบอกจุดที่สามารถไปได้จะประกอบไปด้วย
\begin{enumerate}
    \item ความกว้างของด่าน
    \item ความลึกของด่าน
    \item ความสูงของด่าน
    \item ตั้งแต่บรรทัดนี้เป็นต้นไป เป็นการกำหนดจุดที่ผู้เล่นสามารถเดินไปได้ อิงตามความกว้าง/ความลึก/ความสูงของด่าน ที่ระบุมาก่อนหน้านี้ โดยมีสัญลักษณ์ให้ใช้ดังนี้
    \begin{itemize}
        \item 0 -- ไม่สามารถเดินไปจุดนี้ได้
        \item 1 -- สามารถเดินไปจุดนี้ได้
        \item P -- จุดเกิดของตัวละคร
        \item G -- เส้นชัย
    \end{itemize}
\end{enumerate}
การที่มีไฟล์ text ดังกล่าวทำให้เราสามารถตรวจสอบผลแพ้ชนะได้ โดยนำชุดคำสั่งที่ผู้ใช้ป้อนเข้ามา มาร่วมประมวลผล หากผู้ใช้ไปเหยียบจุดที่เป็น 0
หรือตำแหน่งสุดท้ายของผู้เล่นไม่ใช่ G ก็จะแพ้ทันที รูปที่~\ref{ft2} แสดงตัวอย่างของไฟล์ text สำหรับบอกจุดที่สามารถไปได้
\begin{figure}[h!]
    \begin{center}
    \includegraphics[width=1in]{pic-toro/filetext2.png}
    \end{center}
    \caption[Text]{ไฟล์ text สำหรับบอกจุดที่สามารถไปได้}
    \label{ft2}
    \end{figure}
\CIreply{looks like the figures are swapped?}
